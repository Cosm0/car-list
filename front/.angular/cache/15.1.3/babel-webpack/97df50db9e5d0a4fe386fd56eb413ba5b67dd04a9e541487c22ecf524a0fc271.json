{"ast":null,"code":"import { exhaustMap, map, take } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../auth.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nexport class SigninComponent {\n  constructor(authService, router) {\n    this.authService = authService;\n    this.router = router;\n  }\n  ngOnInit() {\n    console.log('signing componetn');\n    this.signInSub = this.authService.signIn$.pipe(exhaustMap(({\n      username,\n      password\n    }) => {\n      console.log('logging in');\n      return this.authService.signIn(username, password);\n    })).subscribe({\n      next: response => {\n        this.router.navigate(['/vehicles']);\n      },\n      error: err => console.log(`Error occurred: `, err.error.error)\n    });\n    this.authService.user$.pipe(take(1), map(user => !!user)).subscribe({\n      next: isSignedIn => {\n        if (isSignedIn) {\n          this.router.navigate(['/vehicles']);\n        }\n      },\n      error: err => console.log('Something went wrong')\n    });\n  }\n  ngOnDestroy() {\n    this.signInSub.unsubscribe();\n  }\n  onSubmit() {\n    console.log('submit');\n    if (this.form.valid) {\n      this.authService.signInTrigger(this.form.value.username, this.form.value.password);\n    }\n  }\n}\nSigninComponent.ɵfac = function SigninComponent_Factory(t) {\n  return new (t || SigninComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.Router));\n};\nSigninComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: SigninComponent,\n  selectors: [[\"app-signin\"]],\n  decls: 12,\n  vars: 1,\n  consts: [[1, \"container\", \"mtvh-30\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\"], [\"for\", \"username\"], [\"formControlName\", \"username\", \"type\", \"text\", \"id\", \"usernameInput\", \"placeholder\", \"username\", 1, \"form-control\"], [\"for\", \"password\"], [\"formControlName\", \"password\", \"type\", \"password\", \"id\", \"passwordInput\", \"placeholder\", \"password\", 1, \"form-control\"], [\"type\", \"submit\", 1, \"btn\", \"btn-default\"]],\n  template: function SigninComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"form\", 1);\n      i0.ɵɵlistener(\"ngSubmit\", function SigninComponent_Template_form_ngSubmit_1_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵelementStart(2, \"div\", 2)(3, \"label\", 3);\n      i0.ɵɵtext(4, \"Username\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(5, \"input\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"div\", 2)(7, \"label\", 5);\n      i0.ɵɵtext(8, \"Password\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(9, \"input\", 6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"button\", 7);\n      i0.ɵɵtext(11, \"Submit\");\n      i0.ɵɵelementEnd()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formGroup\", ctx.form);\n    }\n  },\n  dependencies: [i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.FormControlName],\n  styles: [\".container[_ngcontent-%COMP%] {\\n  width: 600px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvYXV0aC9zaWduaW4vc2lnbmluLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxZQUFZO0FBQ2QiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyIHtcbiAgd2lkdGg6IDYwMHB4O1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"AAEA,SAASA,UAAU,EAAEC,GAAG,EAAgBC,IAAI,QAAQ,MAAM;;;;;AAU1D,OAAM,MAAOC,eAAe;EAK1BC,YAAoBC,WAAwB,EAAUC,MAAc;IAAhD,gBAAW,GAAXD,WAAW;IAAuB,WAAM,GAANC,MAAM;EAAW;EAEvEC,QAAQ;IACNC,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;IAEhC,IAAI,CAACC,SAAS,GAAG,IAAI,CAACL,WAAW,CAACM,OAAO,CACtCC,IAAI,CAACZ,UAAU,CAAC,CAAC;MAACa,QAAQ;MAAEC;IAAQ,CAAC,KAAI;MACxCN,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC;MAEzB,OAAO,IAAI,CAACJ,WAAW,CAACU,MAAM,CAACF,QAAQ,EAAEC,QAAQ,CAAC;IACpD,CAAC,CAAC,CAAC,CACFE,SAAS,CAAC;MACTC,IAAI,EAAGC,QAAQ,IAAI;QACjB,IAAI,CAACZ,MAAM,CAACa,QAAQ,CAAC,CAAC,WAAW,CAAC,CAAC;MACrC,CAAC;MACDC,KAAK,EAAGC,GAAG,IAAKb,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEY,GAAG,CAACD,KAAK,CAACA,KAAK;KAChE,CAAC;IAEF,IAAI,CAACf,WAAW,CAACiB,KAAK,CAACV,IAAI,CACvBV,IAAI,CAAC,CAAC,CAAC,EACPD,GAAG,CAAEsB,IAAI,IAAK,CAAC,CAACA,IAAI,CAAC,CAAC,CACvBP,SAAS,CAAC;MACTC,IAAI,EAAGO,UAAU,IAAI;QACnB,IAAGA,UAAU,EAAE;UACb,IAAI,CAAClB,MAAM,CAACa,QAAQ,CAAC,CAAC,WAAW,CAAC,CAAC;;MAEvC,CAAC;MACDC,KAAK,EAAGC,GAAG,IAAKb,OAAO,CAACC,GAAG,CAAC,sBAAsB;KACnD,CAAC;EACR;EAEAgB,WAAW;IACT,IAAI,CAACf,SAAS,CAACgB,WAAW,EAAE;EAC9B;EAEAC,QAAQ;IACNnB,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;IAErB,IAAG,IAAI,CAACmB,IAAI,CAACC,KAAK,EAAE;MAClB,IAAI,CAACxB,WAAW,CAACyB,aAAa,CAAC,IAAI,CAACF,IAAI,CAACG,KAAK,CAAClB,QAAQ,EAAE,IAAI,CAACe,IAAI,CAACG,KAAK,CAACjB,QAAQ,CAAC;;EAEtF;;AA9CWX,eAAe;mBAAfA,eAAe;AAAA;AAAfA,eAAe;QAAfA,eAAe;EAAA6B;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCZ5BC,8BAA+B;MACJA;QAAA,OAAYC,cAAU;MAAA,EAAC;MAC9CD,8BAAwB;MACAA,wBAAQ;MAAAA,iBAAQ;MACtCA,2BAKyB;MAC3BA,iBAAM;MACNA,8BAAwB;MACAA,wBAAQ;MAAAA,iBAAQ;MACtCA,2BAKyB;MAC3BA,iBAAM;MACNA,kCAA8C;MAAAA,uBAAM;MAAAA,iBAAS;;;MAnBzDA,eAAkB;MAAlBA,oCAAkB","names":["exhaustMap","map","take","SigninComponent","constructor","authService","router","ngOnInit","console","log","signInSub","signIn$","pipe","username","password","signIn","subscribe","next","response","navigate","error","err","user$","user","isSignedIn","ngOnDestroy","unsubscribe","onSubmit","form","valid","signInTrigger","value","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["/home/ppodsiadlik/repo-prv/car-list/front/src/app/auth/signin/signin.component.ts","/home/ppodsiadlik/repo-prv/car-list/front/src/app/auth/signin/signin.component.html"],"sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { exhaustMap, map, Subscription, take } from 'rxjs';\nimport { Router } from '@angular/router';\n\nimport { AuthService } from '../auth.service';\n\n@Component({\n  selector: 'app-signin',\n  templateUrl: './signin.component.html',\n  styleUrls: ['./signin.component.css']\n})\nexport class SigninComponent implements OnInit, OnDestroy {\n  form: FormGroup;\n\n  private signInSub: Subscription;\n\n  constructor(private authService: AuthService, private router: Router) {}\n\n  ngOnInit(): void {\n    console.log('signing componetn');\n\n    this.signInSub = this.authService.signIn$\n      .pipe(exhaustMap(({username, password}) => {\n        console.log('logging in');\n\n        return this.authService.signIn(username, password);\n      }))\n      .subscribe({\n        next: (response) => {\n          this.router.navigate(['/vehicles']);\n        },\n        error: (err) => console.log(`Error occurred: `, err.error.error),\n      });\n\n      this.authService.user$.pipe(\n          take(1),\n          map((user) => !!user))\n        .subscribe({\n          next: (isSignedIn) => {\n            if(isSignedIn) {\n              this.router.navigate(['/vehicles'])\n            }\n          },\n          error: (err) => console.log('Something went wrong')\n        });\n  }\n\n  ngOnDestroy(): void {\n    this.signInSub.unsubscribe();\n  }\n\n  onSubmit() {\n    console.log('submit');\n\n    if(this.form.valid) {\n      this.authService.signInTrigger(this.form.value.username, this.form.value.password);\n    }\n  }\n}\n","<div class=\"container mtvh-30\">\n  <form [formGroup]=\"form\" (ngSubmit)=\"onSubmit()\">\n    <div class=\"form-group\">\n      <label for=\"username\">Username</label>\n      <input\n        formControlName=\"username\"\n        type=\"text\"\n        class=\"form-control\"\n        id=\"usernameInput\"\n        placeholder=\"username\">\n    </div>\n    <div class=\"form-group\">\n      <label for=\"password\">Password</label>\n      <input\n        formControlName=\"password\"\n        type=\"password\"\n        class=\"form-control\"\n        id=\"passwordInput\"\n        placeholder=\"password\">\n    </div>\n    <button type=\"submit\" class=\"btn btn-default\">Submit</button>\n  </form>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}